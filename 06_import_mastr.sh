python3 05_upsert_teilnehmer.py -u https://wattbewerb.herokuapp.com/api/v1/competitors -d $1
psql -d $1 -c "TRUNCATE TABLE mastr.mastr;"
psql -d $1 -c "\COPY mastr.mastr (Id,AnlagenbetreiberId,AnlagenbetreiberPersonenArt,AnlagenbetreiberMaskedName,AnlagenbetreiberMaStRNummer,AnlagenbetreiberName,BetriebsStatusId,Breitengrad,BundeslandId,DatumLetzteAktualisierung,EinheitRegistrierungsdatum,EinheitName,EndgueltigeStilllegungDatum,Flurstueck,Gemarkung,Gemeinde,Gemeindeschluessel,GeplantesInbetriebsnahmeDatum,Hausnummer,InbetriebnahmeDatum,IsNBPruefungAbgeschlossen,Laengengrad,LandId,Landkreis,LokationId,LokationMastrNr,MaStRNummer,NetzbetreiberId,NetzbetreiberMaskedNamen,NetzbetreiberMaStRNummer,NetzbetreiberNamen,NetzbetreiberPersonenArt,Ort,Plz,Strasse,SystemStatusId,Typ,AktenzeichenGenehmigung,AnzahlSolarModule,Batterietechnologie,BiomasseArt,Bruttoleistung,EegInbetriebnahmeDatum,EegInstallierteLeistung,EegAnlageMastrNummer,EegAnlageRegistrierungsdatum,EegAnlagenschluessel,EegZuschlag,EnergietraegerId,EnergietraegerName,Genehmigungbehoerde,GenehmigungRegistrierungsdatum,GenehmigungsMastrNummer,Gruppierungsobjekte,GruppierungsobjekteIds,HatFlexibilitaetspraemie,HauptausrichtungSolarModule,HauptbrennstoffId,HauptneigungswinkelSolarmodule,HerstellerWindenergieanlage,HerstellerWindenergieanlageBezeichnung,IsAnonymisiert,IsBuergerenergie,IsEinheitNotstromaggregat,KraftwerkName,KraftwerkBlockName,KwkAnlageElektrischeLeistung,KwkAnlageInbetriebnahmedatum,KwkAnlageMastrNummer,KwkAnlageRegistrierungsdatum,KwkZuschlag,LageEinheit,LageEinheitBezeichnung,Leistungsbegrenzung,MieterstromAngemeldet,MigrationseinheitMastrNummer,NabenhoeheWindenergieanlage,Nettonennleistung,NutzbareSpeicherkapazitaet,NutzungsbereichGebSA,Pilotwindanlage,Prototypanlage,Regelzone,RotordurchmesserWindenergieanlage,Stromspeichertechnologie,SpannungsebenenId,SpannungsebenenNamen,ArtDerFlaecheBezeichnung,SpeicherEinheitMastrNummer,TechnologieStromerzeugungId,ThermischeNutzleistung,Typenbezeichnung,VollTeilEinspeisung,WasserkraftErtuechtigung,WindClusterOstseeId,WindClusterNordseeId,WindparkName) FROM '$PWD/out/mastr.csv' DELIMITER ',' CSV HEADER;"
psql -d $1 -f scripts/sql/refresh_matviews.sql